load "iovtk"
int[int] order = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];

include "Parameters.edp"
cout << Lfrac << endl;
include "FiltrationMeshGen.edp"
// plot(Th, wait=1);
for(int i = 1; i<5; i++){
    Lfrac = Lfrac + i*5;
    include "FiltrationMeshGen.edp"
    fespace Vh(Th, P2);
    Vh f = sin(2*pi*x/L)*cos(2*pi*y/H);
    savevtk("./Results/TestResults" + i + ".vtu", Th, f, dataname = "f", order=order);
    // plot(Th, f, wait=1);
}
cout << Lfrac << endl;